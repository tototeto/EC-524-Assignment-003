"0","# Find the sex"
"0","sex = penguins$sex |> unique()"
"0",""
"0","suppress_2 <- lapply(X = sex, FUN = function(i) {"
"0",""
"0","  grp1 = penguins |> filter(sex == i)"
"0","  grp2 = penguins |> filter(sex != i)"
"0","  # Find the modal species in each group"
"0","  species1 = grp1$species |> fmode()"
"0","  species2 = grp2$species |> fmode()"
"0","  # Calculate accuracy"
"0","  print(paste(""Accuracy, "", i, "": "", fmean(grp1$species == species1)))"
"0","  print(paste(""Accuracy, "", i, "": "", fmean(grp2$species == species2)))"
"0","  # Calculate gini"
"0","  g1 = grp1$species |> table() |> prop.table()"
"0","  g2 = grp2$species |> table() |> prop.table()"
"0","  gini1 = sum(g1 * (1 - g1))"
"0","  gini2 = sum(g2 * (1 - g2))"
"0","  print(paste(""Gini, "", i, "": "", (gini1 + gini2)/2))"
"0","})"
"1","[1]"
"1"," ""Accuracy,  male :  0.43452380952381"""
"1","
"
"1","[1]"
"1"," ""Accuracy,  male :  0.442424242424242"""
"1","
"
"1","[1]"
"1"," ""Gini,  male :  0.638314885871704"""
"1","
"
"1","[1]"
"1"," ""Accuracy,  female :  0.442424242424242"""
"1","
"
"1","[1]"
"1"," ""Accuracy,  female :  0.43452380952381"""
"1","
"
"1","[1]"
"1"," ""Gini,  female :  0.638314885871704"""
"1","
"
"1","[1]"
"1"," ""Accuracy,  NA :  NA"""
"1","
"
"1","[1]"
"1"," ""Accuracy,  NA :  NA"""
"1","
"
"1","[1]"
"1"," ""Gini,  NA :  NaN"""
"1","
"
