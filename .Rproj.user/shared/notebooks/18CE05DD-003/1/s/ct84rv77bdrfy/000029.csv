"0","# Define parameter ranges
mtry_b = seq(from = 1, to = ncol(penguins), length.out = ncol(penguins))
trees_b = floor(10^seq(from = 0, to = 3, by = 1))
min_n_b = seq(from = 1, to = 10, by = 5)
learn_rate_b = (10^seq(from = -4, to = 0, by = 0.5))
tree_depth_b = seq(from=1,to=10,by=2)

wkfl_b <-workflow() %>% 
  add_model(mod_b) %>% 
  add_recipe(rec_b)

cl <- makeCluster(detectCores() - 1)
registerDoParallel(cl)

tgrid_b <- expand_grid(
      mtry = mtry_b,
      trees = trees_b,
      min_n = min_n_b,
      learn_rate = learn_rate_b,
      tree_depth = tree_depth_b)

cv_b <- wkfl_b %>% 
  tune_grid(
    peng_cv_f,
    grid = tgrid_b,
    metrics = metric_set(accuracy),
    control = control_grid(save_pred = TRUE, verbose = TRUE, parallel_over = ""everything"") # Parellel
  )

stopCluster(cl)

best_b <- show_best(cv_b)

# Print results

cat(
  ""\n------------------------------------------------\n"", 
  ""Tuned Parameters:\nNumber of Predictors Sampled:"",
  best_b$mtry[1] , ""\nNumber of Trees: "",
  best_b$trees[1], ""\nMinimum Data Points per Node: "", best_b$min_n[1],
  ""\nAccuracy: "", best_b$mean[1], 
  ""\nShrinkage Parameter: "", best_b$learn_rate[1],
  ""\nTree Depth: "", best_b$tree_depth[1],
  ""\n------------------------------------------------\n""
)
"
"1","
------------------------------------------------
"
"1"," "
"1","Tuned Parameters:
Number of Predictors Sampled:"
"1"," "
"1","2"
"1"," "
"1","
Number of Trees: "
"1"," "
"1","1000"
"1"," "
"1","
Minimum Data Points per Node: "
"1"," "
"1","1"
"1"," "
"1","
Accuracy: "
"1"," "
"1","0.985422"
"1"," "
"1","
Shrinkage Parameter: "
"1"," "
"1","0.3162278"
"1"," "
"1","
Tree Depth: "
"1"," "
"1","1"
"1"," "
"1","
------------------------------------------------
"
